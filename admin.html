<!DOCTYPE html>
<html lang="el">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex, nofollow">
    <title>KYW Admin</title>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@300;400;500;600;700&family=Instrument+Serif:ital@0;1&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg: #0D1B2A;
            --bg-card: #111F30;
            --bg-card-hover: #162638;
            --bg-input: #131E2D;
            --border: #1E3044;
            --border-light: #2A4058;
            --text: #E2E8F0;
            --text-muted: #7A8FA0;
            --text-dim: #4A6070;
            --accent: #00B4D8;
            --accent-hover: #48CAE4;
            --accent-glow: rgba(0, 180, 216, 0.12);
            --cyan: #48CAE4;
            --spark: #FF7F45;
            --green: #34D399;
            --green-bg: rgba(52, 211, 153, 0.08);
            --red: #F87171;
            --red-bg: rgba(248, 113, 113, 0.08);
            --orange: #FF6B35;
            --orange-bg: rgba(255, 107, 53, 0.08);
            --radius: 12px;
            --radius-sm: 8px;
            --radius-lg: 20px;
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: 'DM Sans', sans-serif;
            background: var(--bg);
            color: var(--text);
            min-height: 100vh;
        }

        /* ===== TOPBAR ===== */
        .topbar {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 0.75rem 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            position: sticky;
            top: 0;
            z-index: 100;
        }
        .topbar-brand {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            font-size: 1rem;
        }
        .topbar-brand .k { color: #fff; font-weight: 400; }
        .topbar-brand .y { color: #fff; font-weight: 700; }
        .topbar-brand .w { color: var(--cyan); font-weight: 700; }
        .topbar-badge {
            background: var(--spark);
            color: white;
            font-size: 0.65rem;
            font-weight: 600;
            padding: 0.15rem 0.5rem;
            border-radius: 100px;
            letter-spacing: 0.04em;
        }
        .topbar-actions {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        .topbar-link {
            color: var(--text-muted);
            font-size: 0.8rem;
            text-decoration: none;
            transition: color 0.2s;
        }
        .topbar-link:hover { color: var(--cyan); }

        /* ===== TABS ===== */
        .tab-bar {
            display: flex;
            gap: 0.25rem;
            padding: 1rem 1.5rem 0;
            max-width: 1100px;
            margin: 0 auto;
        }
        .tab-btn {
            padding: 0.65rem 1.5rem;
            border-radius: 8px 8px 0 0;
            font-size: 0.85rem;
            font-weight: 500;
            border: 1px solid transparent;
            border-bottom: none;
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            font-family: 'DM Sans';
        }
        .tab-btn:hover { color: var(--text); background: rgba(255,255,255,0.03); }
        .tab-btn.active {
            background: var(--bg-card);
            border-color: var(--border);
            color: var(--cyan);
        }

        /* ===== MAIN ===== */
        .main {
            max-width: 1100px;
            margin: 0 auto;
            padding: 0 1.5rem 3rem;
        }
        .tab-panel { display: none; }
        .tab-panel.active { display: block; animation: fadeIn 0.3s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }

        /* ===== CARDS ===== */
        .card {
            background: var(--bg-card);
            border: 1px solid var(--border);
            border-radius: var(--radius-lg);
            margin-bottom: 1.5rem;
            overflow: hidden;
        }
        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 1.5rem;
            border-bottom: 1px solid var(--border);
        }
        .card-header h3 { font-size: 0.95rem; font-weight: 600; }
        .card-body { padding: 1.5rem; }

        /* ===== FORM ===== */
        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1rem; }
        .form-row.full { grid-template-columns: 1fr; }
        .form-row.three { grid-template-columns: 1fr 1fr 100px; }
        .form-group { display: flex; flex-direction: column; gap: 0.35rem; }
        .form-group label {
            font-size: 0.75rem;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.04em;
        }
        .form-group input, .form-group select, .form-group textarea {
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            padding: 0.7rem 0.9rem;
            font-size: 0.9rem;
            color: var(--text);
            font-family: 'DM Sans';
            outline: none;
            transition: border-color 0.2s;
        }
        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            border-color: var(--accent);
        }
        .form-group select {
            cursor: pointer;
            -webkit-appearance: none;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' fill='%238888A0' viewBox='0 0 16 16'%3E%3Cpath d='M8 11L3 6h10z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 0.8rem center;
            padding-right: 2rem;
        }
        .form-group textarea { resize: vertical; min-height: 100px; }
        .form-hint { font-size: 0.72rem; color: var(--text-dim); margin-top: 0.15rem; }

        /* ===== WYSIWYG TOOLBAR ===== */
        .editor-wrap {
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            overflow: hidden;
        }
        .editor-toolbar {
            display: flex;
            flex-wrap: wrap;
            gap: 0.15rem;
            padding: 0.4rem 0.5rem;
            background: var(--bg);
            border-bottom: 1px solid var(--border);
        }
        .editor-toolbar button {
            background: transparent;
            border: 1px solid transparent;
            color: var(--text-muted);
            border-radius: 4px;
            width: 32px;
            height: 32px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 0.85rem;
            font-family: 'DM Sans';
            transition: all 0.15s;
        }
        .editor-toolbar button:hover { background: var(--bg-card); color: var(--text); border-color: var(--border); }
        .editor-toolbar button.active { background: var(--accent-glow); color: var(--cyan); border-color: rgba(0,180,216,0.3); }
        .editor-toolbar .sep {
            width: 1px;
            background: var(--border);
            margin: 0 0.25rem;
            align-self: stretch;
        }
        .editor-toolbar select {
            background: var(--bg-card);
            border: 1px solid var(--border);
            color: var(--text);
            border-radius: 4px;
            padding: 0.25rem 0.4rem;
            font-size: 0.75rem;
            font-family: 'DM Sans';
            cursor: pointer;
            outline: none;
        }
        .editor-content {
            min-height: 350px;
            padding: 1rem;
            color: var(--text-muted);
            font-size: 0.95rem;
            line-height: 1.7;
            outline: none;
            background: var(--bg-input);
        }
        .editor-content h2 { color: var(--text); font-size: 1.3rem; margin: 1.5rem 0 0.5rem; }
        .editor-content h3 { color: var(--text); font-size: 1.1rem; margin: 1rem 0 0.4rem; }
        .editor-content p { margin-bottom: 0.75rem; }
        .editor-content a { color: var(--cyan); }
        .editor-content:empty::before {
            content: attr(data-placeholder);
            color: var(--text-dim);
        }

        /* Source code view */
        .source-view {
            display: none;
            min-height: 350px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 0.82rem;
            line-height: 1.6;
            background: var(--bg-input);
            color: var(--green);
            border: none;
            outline: none;
            resize: vertical;
            width: 100%;
        }

        /* ===== BUTTONS ===== */
        .btn {
            padding: 0.65rem 1.5rem;
            border-radius: var(--radius-sm);
            font-size: 0.9rem;
            font-weight: 600;
            cursor: pointer;
            font-family: 'DM Sans';
            transition: all 0.2s;
            border: none;
        }
        .btn-primary { background: var(--accent); color: white; }
        .btn-primary:hover { background: var(--accent-hover); }
        .btn-secondary { background: transparent; color: var(--text-muted); border: 1px solid var(--border); }
        .btn-secondary:hover { border-color: var(--text-muted); color: var(--text); }
        .btn-danger { background: var(--red-bg); color: var(--red); border: 1px solid rgba(248,113,113,0.2); }
        .btn-danger:hover { background: rgba(248,113,113,0.15); }
        .btn-sm { font-size: 0.78rem; padding: 0.4rem 0.9rem; }
        .btn-group { display: flex; gap: 0.75rem; margin-top: 1rem; }

        /* ===== TABLE LIST ===== */
        .item-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 1rem;
            border-bottom: 1px solid var(--border);
            transition: background 0.15s;
        }
        .item-row:hover { background: rgba(255,255,255,0.015); }
        .item-row:last-child { border-bottom: none; }
        .item-info { flex: 1; min-width: 0; }
        .item-title { font-size: 0.88rem; font-weight: 500; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .item-meta { font-size: 0.72rem; color: var(--text-dim); margin-top: 0.15rem; }
        .item-actions { display: flex; gap: 0.35rem; flex-shrink: 0; }
        .item-btn {
            width: 30px;
            height: 30px;
            border-radius: 6px;
            border: 1px solid var(--border);
            background: transparent;
            color: var(--text-muted);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            transition: all 0.15s;
        }
        .item-btn:hover { border-color: var(--cyan); color: var(--cyan); background: var(--accent-glow); }
        .item-btn.del:hover { border-color: var(--red); color: var(--red); background: var(--red-bg); }

        /* ===== TAG BADGES ===== */
        .tag-badge {
            display: inline-block;
            padding: 0.12rem 0.5rem;
            border-radius: 100px;
            font-size: 0.68rem;
            font-weight: 500;
            background: var(--accent-glow);
            color: var(--cyan);
            margin-left: 0.5rem;
        }

        /* ===== STATUS ===== */
        .status-msg {
            padding: 0.75rem 1rem;
            border-radius: var(--radius-sm);
            font-size: 0.85rem;
            margin-top: 1rem;
            display: none;
        }
        .status-msg.success { display: block; background: var(--green-bg); color: var(--green); border: 1px solid rgba(52,211,153,0.2); }
        .status-msg.error { display: block; background: var(--red-bg); color: var(--red); border: 1px solid rgba(248,113,113,0.2); }

        /* ===== IMAGE UPLOAD ===== */
        .upload-area {
            border: 2px dashed var(--border);
            border-radius: var(--radius-sm);
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s;
        }
        .upload-area:hover { border-color: var(--accent); background: rgba(0,180,216,0.03); }
        .upload-area.has-file { border-color: var(--green); border-style: solid; }
        .upload-preview {
            max-height: 120px;
            border-radius: 6px;
            margin-top: 0.5rem;
        }

        /* ===== Q&A SPECIFIC ===== */
        .keyword-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 0.35rem;
            padding: 0.5rem;
            background: var(--bg-input);
            border: 1px solid var(--border);
            border-radius: var(--radius-sm);
            min-height: 42px;
            cursor: text;
        }
        .keyword-tags:focus-within { border-color: var(--accent); }
        .keyword-tag {
            display: inline-flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.2rem 0.55rem;
            background: var(--accent-glow);
            color: var(--cyan);
            border-radius: 100px;
            font-size: 0.78rem;
        }
        .keyword-tag .remove {
            cursor: pointer;
            font-size: 0.9rem;
            line-height: 1;
            opacity: 0.6;
            transition: opacity 0.15s;
        }
        .keyword-tag .remove:hover { opacity: 1; }
        .keyword-input {
            border: none;
            background: none;
            color: var(--text);
            font-family: 'DM Sans';
            font-size: 0.85rem;
            outline: none;
            flex: 1;
            min-width: 80px;
            padding: 0.2rem;
        }

        /* ===== SEO PREVIEW ===== */
        .seo-preview {
            background: #fff;
            border-radius: var(--radius-sm);
            padding: 1rem;
            margin-top: 0.75rem;
        }
        .seo-preview-title {
            color: #1a0dab;
            font-size: 1.1rem;
            font-weight: 400;
            line-height: 1.3;
            margin-bottom: 0.2rem;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }
        .seo-preview-url {
            color: #006621;
            font-size: 0.82rem;
            margin-bottom: 0.25rem;
        }
        .seo-preview-desc {
            color: #545454;
            font-size: 0.82rem;
            line-height: 1.4;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* ===== RESPONSIVE ===== */
        @media (max-width: 768px) {
            .form-row, .form-row.three { grid-template-columns: 1fr; }
            .tab-bar { overflow-x: auto; flex-wrap: nowrap; }
            .tab-btn { white-space: nowrap; font-size: 0.8rem; padding: 0.55rem 1rem; }
            .card-body { padding: 1rem; }
            .editor-content { min-height: 250px; }
        }

        /* ===== TOGGLE ===== */
        .toggle-wrap {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        .toggle {
            width: 40px; height: 22px;
            background: var(--border);
            border-radius: 100px;
            position: relative;
            cursor: pointer;
            transition: background 0.2s;
        }
        .toggle.on { background: var(--accent); }
        .toggle::after {
            content: '';
            width: 16px; height: 16px;
            background: white;
            border-radius: 50%;
            position: absolute;
            top: 3px; left: 3px;
            transition: transform 0.2s;
        }
        .toggle.on::after { transform: translateX(18px); }
        .toggle-label { font-size: 0.8rem; color: var(--text-muted); }

        /* Loading */
        .spinner {
            display: inline-block;
            width: 16px; height: 16px;
            border: 2px solid var(--border);
            border-top-color: var(--cyan);
            border-radius: 50%;
            animation: spin 0.6s linear infinite;
            margin-right: 0.4rem;
        }
        @keyframes spin { to { transform: rotate(360deg); } }
    </style>
</head>
<body>

<!-- ===== PASSWORD GATE ===== -->
<div id="authGate" style="display:flex;align-items:center;justify-content:center;min-height:100vh;padding:2rem;">
    <div style="background:var(--bg-card);border:1px solid var(--border);border-radius:20px;padding:2.5rem;max-width:380px;width:100%;text-align:center;">
        <div style="font-size:1.1rem;margin-bottom:0.25rem;"><span style="color:#fff;font-weight:400;">Know</span><span style="color:#fff;font-weight:700;">Your</span><span style="color:var(--cyan);font-weight:700;">Work</span></div>
        <div style="font-size:0.7rem;color:var(--spark);font-weight:600;letter-spacing:0.05em;margin-bottom:1.5rem;">ADMIN</div>
        <input type="password" id="authPass" placeholder="ÎšÏ‰Î´Î¹ÎºÏŒÏ‚..." onkeypress="if(event.key==='Enter')checkAuth()" style="width:100%;padding:0.75rem 1rem;background:var(--bg-input);border:1px solid var(--border);border-radius:8px;color:var(--text);font-family:'DM Sans';font-size:0.95rem;outline:none;margin-bottom:0.75rem;text-align:center;">
        <button onclick="checkAuth()" style="width:100%;padding:0.7rem;background:var(--accent);color:white;border:none;border-radius:8px;font-size:0.9rem;font-weight:600;cursor:pointer;font-family:'DM Sans';">Î•Î¯ÏƒÎ¿Î´Î¿Ï‚</button>
        <p id="authError" style="color:var(--red);font-size:0.8rem;margin-top:0.75rem;display:none;">Î›Î¬Î¸Î¿Ï‚ ÎºÏ‰Î´Î¹ÎºÏŒÏ‚</p>
    </div>
</div>

<!-- ===== MAIN APP (hidden until auth) ===== -->
<div id="mainApp" style="display:none;">

<!-- ===== TOPBAR ===== -->
<div class="topbar">
    <div class="topbar-brand">
        <span><span class="k">Know</span><span class="y">Your</span><span class="w">Work</span></span>
        <span class="topbar-badge">ADMIN</span>
    </div>
    <div class="topbar-actions">
        <a href="/" class="topbar-link">â† Î Î¯ÏƒÏ‰ ÏƒÏ„Î¿ site</a>
    </div>
</div>

<!-- ===== TABS ===== -->
<div class="tab-bar">
    <button class="tab-btn active" onclick="switchTab('blog')">ğŸ“ Blog Editor</button>
    <button class="tab-btn" onclick="switchTab('qa')">ğŸ’¬ Q&A Editor</button>
    <button class="tab-btn" onclick="switchTab('list')">ğŸ“š ÎŒÎ»Î± Ï„Î± Î†ÏÎ¸ÏÎ±</button>
    <button class="tab-btn" onclick="switchTab('qalist')">ğŸ“‹ ÎŒÎ»Î± Ï„Î± Q&A</button>
</div>

<!-- ===== MAIN ===== -->
<div class="main">

    <!-- ==================== BLOG EDITOR ==================== -->
    <div class="tab-panel active" id="panel-blog">
        <div class="card">
            <div class="card-header">
                <h3 id="blogFormTitle">âœï¸ ÎÎ­Î¿ Î†ÏÎ¸ÏÎ¿</h3>
                <button class="btn btn-secondary btn-sm" onclick="resetBlogForm()">ğŸ”„ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚</button>
            </div>
            <div class="card-body">
                <input type="hidden" id="blogEditId" value="">

                <!-- Title & Tag -->
                <div class="form-row three">
                    <div class="form-group">
                        <label>Î¤Î¯Ï„Î»Î¿Ï‚</label>
                        <input type="text" id="blogTitle" placeholder="Ï€.Ï‡. Î•Ï„Î®ÏƒÎ¹Î± Î†Î´ÎµÎ¹Î± 2026" oninput="updateSeoPreview()">
                    </div>
                    <div class="form-group">
                        <label>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î± (tag)</label>
                        <select id="blogTag">
                            <option value="Î†Î´ÎµÎ¹ÎµÏ‚">ğŸ“… Î†Î´ÎµÎ¹ÎµÏ‚</option>
                            <option value="ÎœÎ¹ÏƒÎ¸ÏŒÏ‚">ğŸ’¶ ÎœÎ¹ÏƒÎ¸ÏŒÏ‚</option>
                            <option value="Î‘Ï€ÏŒÎ»Ï…ÏƒÎ·">âš–ï¸ Î‘Ï€ÏŒÎ»Ï…ÏƒÎ·</option>
                            <option value="Î©ÏÎ¬ÏÎ¹Î¿">â° Î©ÏÎ¬ÏÎ¹Î¿</option>
                            <option value="Î”ÏÏÎ±">ğŸ„ Î”ÏÏÎ±</option>
                            <option value="Î•ÏÎ³Î±ÏƒÎ¯Î±">ğŸ‘· Î•ÏÎ³Î±ÏƒÎ¯Î±</option>
                            <option value="ÎœÎ·Ï„ÏÏŒÏ„Î·Ï„Î±">ğŸ¤° ÎœÎ·Ï„ÏÏŒÏ„Î·Ï„Î±</option>
                            <option value="Î Î±Ï„ÏÏŒÏ„Î·Ï„Î±">ğŸ‘¨â€ğŸ‘§ Î Î±Ï„ÏÏŒÏ„Î·Ï„Î±</option>
                            <option value="ÎÎ­Î¿Î¹">ğŸ“ ÎÎ­Î¿Î¹</option>
                            <option value="Î“ÎµÎ½Î¹ÎºÎ¬">ğŸ“„ Î“ÎµÎ½Î¹ÎºÎ¬</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Emoji</label>
                        <input type="text" id="blogEmoji" value="ğŸ“„" style="text-align:center;font-size:1.2rem;">
                    </div>
                </div>

                <!-- Summary -->
                <div class="form-row full">
                    <div class="form-group">
                        <label>Î ÎµÏÎ¯Î»Î·ÏˆÎ·</label>
                        <input type="text" id="blogSummary" placeholder="1-2 Ï€ÏÎ¿Ï„Î¬ÏƒÎµÎ¹Ï‚..." oninput="updateSeoPreview()">
                    </div>
                </div>

                <!-- Image -->
                <div class="form-row">
                    <div class="form-group">
                        <label>Î•Î¹ÎºÏŒÎ½Î± Î†ÏÎ¸ÏÎ¿Ï…</label>
                        <div class="upload-area" id="blogUploadArea" onclick="document.getElementById('blogImage').click()">
                            <input type="file" id="blogImage" accept="image/*" style="display:none;" onchange="previewImage(this,'blogUploadArea')">
                            <div id="blogImageText">ğŸ“· Î£ÏÏÎµ Î® ÎºÎ»Î¯ÎºÎ±ÏÎµ Î³Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î±</div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Î˜Î­ÏƒÎ· Î•Î¹ÎºÏŒÎ½Î±Ï‚</label>
                        <select id="blogImagePos">
                            <option value="top">Î Î¬Î½Ï‰ Î¼Î­ÏÎ¿Ï‚</option>
                            <option value="20%">Î›Î¯Î³Î¿ Ï€Î¹Î¿ ÎºÎ¬Ï„Ï‰</option>
                            <option value="center" selected>ÎšÎ­Î½Ï„ÏÎ¿</option>
                            <option value="70%">Î›Î¯Î³Î¿ Ï€Î¹Î¿ ÎºÎ¬Ï„Ï‰</option>
                            <option value="bottom">ÎšÎ¬Ï„Ï‰ Î¼Î­ÏÎ¿Ï‚</option>
                        </select>
                        <div class="toggle-wrap" style="margin-top:0.75rem;">
                            <div class="toggle on" id="blogPublished" onclick="this.classList.toggle('on')"></div>
                            <span class="toggle-label">Î”Î·Î¼Î¿ÏƒÎ¹ÎµÏ…Î¼Î­Î½Î¿</span>
                        </div>
                    </div>
                </div>

                <!-- WYSIWYG Editor -->
                <div class="form-row full">
                    <div class="form-group">
                        <label>Î ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿</label>
                        <div class="editor-wrap">
                            <div class="editor-toolbar" id="blogToolbar">
                                <select onchange="execFormat('formatBlock',this.value);this.value='';">
                                    <option value="">ÎœÎ¿ÏÏ†Î®...</option>
                                    <option value="h2">H2 â€” Section</option>
                                    <option value="h3">H3 â€” Subsection</option>
                                    <option value="p">Î Î±ÏÎ¬Î³ÏÎ±Ï†Î¿Ï‚</option>
                                </select>
                                <div class="sep"></div>
                                <button onclick="execCmd('bold')" title="Bold"><b>B</b></button>
                                <button onclick="execCmd('italic')" title="Italic"><i>I</i></button>
                                <button onclick="execCmd('underline')" title="Underline"><u>U</u></button>
                                <div class="sep"></div>
                                <button onclick="execCmd('insertUnorderedList')" title="Bullet list">â€¢</button>
                                <button onclick="execCmd('insertOrderedList')" title="Numbered list">1.</button>
                                <div class="sep"></div>
                                <button onclick="insertLink()" title="Link">ğŸ”—</button>
                                <button onclick="insertCalcLink()" title="Link ÏƒÎµ Calculator">ğŸ§®</button>
                                <button onclick="insertBlogLink()" title="Link ÏƒÎµ Blog Post">ğŸ“</button>
                                <div class="sep"></div>
                                <button onclick="insertEmoji()" title="Emoji">ğŸ˜€</button>
                                <button onclick="toggleSource('blog')" title="HTML Source" id="blogSourceBtn">{ }</button>
                            </div>
                            <div class="editor-content" id="blogEditor" contenteditable="true" data-placeholder="Î“ÏÎ¬ÏˆÎµ Ï„Î¿ Î¬ÏÎ¸ÏÎ¿ ÎµÎ´Ï..."></div>
                            <textarea class="source-view" id="blogSource"></textarea>
                        </div>
                        <div class="form-hint">ğŸ’¡ Blog style: Bold Î¼ÏŒÎ½Î¿ ÏƒÎµ headings, ÎŸÎ§Î™ ÏƒÎµ Î½Î¿ÏÎ¼ÎµÏÎ± ÏƒÏ„Î¿ body text</div>
                    </div>
                </div>

                <!-- SEO Fields -->
                <div class="card" style="margin-top:1rem;background:var(--bg);">
                    <div class="card-header">
                        <h3>ğŸ” SEO</h3>
                    </div>
                    <div class="card-body">
                        <div class="form-row">
                            <div class="form-group">
                                <label>Slug (URL)</label>
                                <input type="text" id="blogSlug" placeholder="auto-generated" oninput="updateSeoPreview()">
                                <div class="form-hint">Î‘Ï†Î®ÏƒÏ„Îµ ÎºÎµÎ½ÏŒ Î³Î¹Î± auto-generate Î±Ï€ÏŒ Ï„Î¿Î½ Ï„Î¯Ï„Î»Î¿</div>
                            </div>
                            <div class="form-group">
                                <label>Meta Title</label>
                                <input type="text" id="blogMetaTitle" placeholder="Î‘Ï†Î®ÏƒÏ„Îµ ÎºÎµÎ½ÏŒ = Ï„Î¯Ï„Î»Î¿Ï‚ Î¬ÏÎ¸ÏÎ¿Ï…" oninput="updateSeoPreview()">
                            </div>
                        </div>
                        <div class="form-row full">
                            <div class="form-group">
                                <label>Meta Description</label>
                                <input type="text" id="blogMetaDesc" placeholder="Î‘Ï†Î®ÏƒÏ„Îµ ÎºÎµÎ½ÏŒ = Ï€ÎµÏÎ¯Î»Î·ÏˆÎ·" oninput="updateSeoPreview()" maxlength="160">
                                <div class="form-hint"><span id="metaDescCount">0</span>/160 Ï‡Î±ÏÎ±ÎºÏ„Î®ÏÎµÏ‚</div>
                            </div>
                        </div>
                        <!-- Google Preview -->
                        <div class="seo-preview">
                            <div class="seo-preview-title" id="seoPreviewTitle">Î¤Î¯Ï„Î»Î¿Ï‚ Î†ÏÎ¸ÏÎ¿Ï… â€” KnowYourWork</div>
                            <div class="seo-preview-url" id="seoPreviewUrl">knowyourwork.gr/blog/slug-arthrou</div>
                            <div class="seo-preview-desc" id="seoPreviewDesc">Î ÎµÏÎ¹Î³ÏÎ±Ï†Î® Ï„Î¿Ï… Î¬ÏÎ¸ÏÎ¿Ï… ÎµÎ´Ï...</div>
                        </div>
                    </div>
                </div>

                <!-- Actions -->
                <div class="btn-group">
                    <button class="btn btn-primary" id="blogSaveBtn" onclick="saveBlogPost()">ğŸ’¾ Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ·</button>
                    <button class="btn btn-secondary" onclick="resetBlogForm()">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
                </div>
                <div class="status-msg" id="blogStatus"></div>
            </div>
        </div>
    </div>

    <!-- ==================== Q&A EDITOR ==================== -->
    <div class="tab-panel" id="panel-qa">
        <div class="card">
            <div class="card-header">
                <h3 id="qaFormTitle">ğŸ’¬ ÎÎ­Î¿ Q&A Entry</h3>
                <button class="btn btn-secondary btn-sm" onclick="resetQaForm()">ğŸ”„ ÎšÎ±Î¸Î±ÏÎ¹ÏƒÎ¼ÏŒÏ‚</button>
            </div>
            <div class="card-body">
                <input type="hidden" id="qaEditId" value="">

                <!-- Question & Category -->
                <div class="form-row">
                    <div class="form-group">
                        <label>Î•ÏÏÏ„Î·ÏƒÎ·</label>
                        <input type="text" id="qaQuestion" placeholder="Ï€.Ï‡. Î ÏŒÏƒÎµÏ‚ Î¼Î­ÏÎµÏ‚ Î¬Î´ÎµÎ¹Î± Î´Î¹ÎºÎ±Î¹Î¿ÏÎ¼Î±Î¹;">
                    </div>
                    <div class="form-group">
                        <label>ÎšÎ±Ï„Î·Î³Î¿ÏÎ¯Î±</label>
                        <select id="qaCategory">
                            <option value="leave">ğŸ“… leave (Î†Î´ÎµÎ¹ÎµÏ‚)</option>
                            <option value="salary">ğŸ’¶ salary (ÎœÎ¹ÏƒÎ¸ÏŒÏ‚)</option>
                            <option value="schedule">â° schedule (Î©ÏÎ¬ÏÎ¹Î¿)</option>
                            <option value="bonus">ğŸ„ bonus (Î”ÏÏÎ±)</option>
                            <option value="employment">ğŸ‘· employment (Î•ÏÎ³Î±ÏƒÎ¯Î±)</option>
                            <option value="general">ğŸ“„ general (Î“ÎµÎ½Î¹ÎºÎ¬)</option>
                        </select>
                    </div>
                </div>

                <!-- Keywords -->
                <div class="form-row full">
                    <div class="form-group">
                        <label>Keywords (Ï€Î¬Ï„Î± Enter Î³Î¹Î± ÎºÎ¬Î¸Îµ keyword)</label>
                        <div class="keyword-tags" id="qaKeywords" onclick="this.querySelector('input').focus()">
                            <input type="text" class="keyword-input" id="qaKeywordInput" placeholder="Î“ÏÎ¬ÏˆÎµ keyword + Enter..." onkeydown="handleKeyword(event)">
                        </div>
                        <div class="form-hint">Î’Î¬Î»Îµ ÎŸÎ›Î•Î£ Ï„Î¹Ï‚ Ï€Î¹Î¸Î±Î½Î­Ï‚ Î»Î­Î¾ÎµÎ¹Ï‚ (Î¼Îµ & Ï‡Ï‰ÏÎ¯Ï‚ Ï„ÏŒÎ½Î¿Ï…Ï‚, greeklish)</div>
                    </div>
                </div>

                <!-- Sort Order -->
                <div class="form-row">
                    <div class="form-group">
                        <label>Sort Order</label>
                        <input type="number" id="qaSortOrder" placeholder="Ï€.Ï‡. 25" min="1">
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <div class="toggle-wrap" style="margin-top:0.5rem;">
                            <div class="toggle on" id="qaActive" onclick="this.classList.toggle('on')"></div>
                            <span class="toggle-label">Î•Î½ÎµÏÎ³ÏŒ</span>
                        </div>
                    </div>
                </div>

                <!-- Answer WYSIWYG -->
                <div class="form-row full">
                    <div class="form-group">
                        <label>Î‘Ï€Î¬Î½Ï„Î·ÏƒÎ·</label>
                        <div class="editor-wrap">
                            <div class="editor-toolbar" id="qaToolbar">
                                <button onclick="execCmd('bold','qa')" title="Bold"><b>B</b></button>
                                <button onclick="execCmd('italic','qa')" title="Italic"><i>I</i></button>
                                <div class="sep"></div>
                                <button onclick="insertBr('qa')" title="Line break (br)">â†µ</button>
                                <button onclick="insertEmoji('qa')" title="Emoji">ğŸ˜€</button>
                                <div class="sep"></div>
                                <button onclick="insertQaBlogLink()" title="ğŸ‘‰ Blog link">ğŸ‘‰ğŸ“</button>
                                <button onclick="insertQaCalcLink()" title="ğŸ‘‰ Calc link">ğŸ‘‰ğŸ§®</button>
                                <div class="sep"></div>
                                <button onclick="toggleSource('qa')" title="HTML Source" id="qaSourceBtn">{ }</button>
                            </div>
                            <div class="editor-content" id="qaEditor" contenteditable="true" data-placeholder="Î“ÏÎ¬ÏˆÎµ Ï„Î·Î½ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·... Î§ÏÎ·ÏƒÎ¹Î¼Î¿Ï€Î¿Î¯Î·ÏƒÎµ bold ÏƒÎµ keywords & Î½Î¿ÏÎ¼ÎµÏÎ±, emojis, Ï„Î­Î»ÎµÎ¹Ï‰ÏƒÎµ Î¼Îµ ğŸ‘‰ link" style="min-height:200px;"></div>
                            <textarea class="source-view" id="qaSource" style="min-height:200px;"></textarea>
                        </div>
                        <div class="form-hint">ğŸ’¡ Q&A style: Bold ÏƒÎµ keywords & Î½Î¿ÏÎ¼ÎµÏÎ±, emojis, Ï„ÎµÎ»ÎµÎ¹ÏÎ½ÎµÎ¹ Î Î‘ÎÎ¤Î‘ Î¼Îµ ğŸ‘‰ link</div>
                    </div>
                </div>

                <!-- SQL Preview -->
                <div class="card" style="margin-top:1rem;background:var(--bg);">
                    <div class="card-header">
                        <h3>ğŸ—ƒï¸ SQL Preview</h3>
                        <button class="btn btn-secondary btn-sm" onclick="copySql()">ğŸ“‹ Copy SQL</button>
                    </div>
                    <div class="card-body">
                        <pre id="qaSqlPreview" style="font-family:'Courier New',monospace;font-size:0.78rem;color:var(--green);line-height:1.6;white-space:pre-wrap;word-break:break-all;">-- Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎµ Ï„Î± Ï€ÎµÎ´Î¯Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰...</pre>
                    </div>
                </div>

                <!-- Actions -->
                <div class="btn-group">
                    <button class="btn btn-primary" id="qaSaveBtn" onclick="saveQaEntry()">ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·</button>
                    <button class="btn btn-secondary" onclick="generateSql()">ğŸ“„ Î”ÎµÏ‚ SQL</button>
                    <button class="btn btn-secondary" onclick="resetQaForm()">Î‘ÎºÏÏÏ‰ÏƒÎ·</button>
                </div>
                <div class="status-msg" id="qaStatus"></div>
            </div>
        </div>
    </div>

    <!-- ==================== BLOG LIST ==================== -->
    <div class="tab-panel" id="panel-list">
        <div class="card">
            <div class="card-header">
                <h3>ğŸ“š ÎŒÎ»Î± Ï„Î± Î†ÏÎ¸ÏÎ±</h3>
                <button class="btn btn-secondary btn-sm" onclick="loadBlogList()">ğŸ”„ Î‘Î½Î±Î½Î­Ï‰ÏƒÎ·</button>
            </div>
            <div id="blogListItems" style="min-height:100px;">
                <div style="padding:2rem;text-align:center;color:var(--text-dim);">Î¦ÏŒÏÏ„Ï‰ÏƒÎ·...</div>
            </div>
        </div>
    </div>

    <!-- ==================== Q&A LIST ==================== -->
    <div class="tab-panel" id="panel-qalist">
        <div class="card">
            <div class="card-header">
                <h3>ğŸ“‹ ÎŒÎ»Î± Ï„Î± Q&A</h3>
                <button class="btn btn-secondary btn-sm" onclick="loadQaList()">ğŸ”„ Î‘Î½Î±Î½Î­Ï‰ÏƒÎ·</button>
            </div>
            <div id="qaListItems" style="min-height:100px;">
                <div style="padding:2rem;text-align:center;color:var(--text-dim);">Î¦ÏŒÏÏ„Ï‰ÏƒÎ·...</div>
            </div>
        </div>
    </div>

</div>

<script>
// ========== SUPABASE CONFIG ==========
var SB_URL = 'https://polsaocrvbtsyadgbmid.supabase.co';
var SB_KEY = 'sb_publishable_S_Hx1AjmIxIOHKdYydvvKA_tthrpq6_';

// ========== SUPABASE HELPERS ==========
async function sbGet(table, query) {
    try {
        var res = await fetch(SB_URL + '/rest/v1/' + table + '?' + (query || ''), {
            headers: { 'apikey': SB_KEY, 'Authorization': 'Bearer ' + SB_KEY }
        });
        if (!res.ok) throw new Error(res.status);
        return await res.json();
    } catch(e) { console.error('GET error:', e); return null; }
}

async function sbInsert(table, data) {
    var res = await fetch(SB_URL + '/rest/v1/' + table, {
        method: 'POST',
        headers: {
            'apikey': SB_KEY, 'Authorization': 'Bearer ' + SB_KEY,
            'Content-Type': 'application/json', 'Prefer': 'return=representation'
        },
        body: JSON.stringify(data)
    });
    if (!res.ok) throw new Error('Insert failed: ' + res.status);
    return await res.json();
}

async function sbUpdate(table, id, data) {
    var res = await fetch(SB_URL + '/rest/v1/' + table + '?id=eq.' + id, {
        method: 'PATCH',
        headers: {
            'apikey': SB_KEY, 'Authorization': 'Bearer ' + SB_KEY,
            'Content-Type': 'application/json', 'Prefer': 'return=minimal'
        },
        body: JSON.stringify(data)
    });
    if (!res.ok) throw new Error('Update failed: ' + res.status);
}

async function sbDelete(table, id) {
    var res = await fetch(SB_URL + '/rest/v1/' + table + '?id=eq.' + id, {
        method: 'DELETE',
        headers: { 'apikey': SB_KEY, 'Authorization': 'Bearer ' + SB_KEY }
    });
    if (!res.ok) throw new Error('Delete failed: ' + res.status);
}

async function sbUploadImage(file) {
    var ext = file.name.split('.').pop();
    var fileName = Date.now() + '-' + Math.random().toString(36).substr(2,6) + '.' + ext;
    var res = await fetch(SB_URL + '/storage/v1/object/blog-images/' + fileName, {
        method: 'POST',
        headers: {
            'apikey': SB_KEY, 'Authorization': 'Bearer ' + SB_KEY,
            'Content-Type': file.type
        },
        body: file
    });
    if (!res.ok) throw new Error('Upload failed: ' + res.status);
    return SB_URL + '/storage/v1/object/public/blog-images/' + fileName;
}

// ========== TAB SWITCHING ==========
function switchTab(tab) {
    document.querySelectorAll('.tab-btn').forEach(function(b,i) {
        b.classList.toggle('active', b.textContent.includes(
            tab === 'blog' ? 'Blog' : tab === 'qa' ? 'Q&A E' : tab === 'list' ? 'Î†ÏÎ¸ÏÎ±' : 'Q&A'
        ) && (tab !== 'qa' || !b.textContent.includes('ÎŒÎ»Î±')) && (tab !== 'qalist' || b.textContent.includes('ÎŒÎ»Î± Ï„Î± Q')));
    });
    // Simpler approach
    document.querySelectorAll('.tab-btn').forEach(function(b) { b.classList.remove('active'); });
    var tabs = ['blog','qa','list','qalist'];
    var btns = document.querySelectorAll('.tab-btn');
    tabs.forEach(function(t,i) { if (t === tab) btns[i].classList.add('active'); });

    document.querySelectorAll('.tab-panel').forEach(function(p) { p.classList.remove('active'); });
    document.getElementById('panel-' + tab).classList.add('active');

    if (tab === 'list') loadBlogList();
    if (tab === 'qalist') loadQaList();
}

// ========== WYSIWYG COMMANDS ==========
function getEditor(target) {
    return target === 'qa' ? document.getElementById('qaEditor') : document.getElementById('blogEditor');
}

function execCmd(cmd, target) {
    getEditor(target).focus();
    document.execCommand(cmd, false, null);
}

function execFormat(cmd, value) {
    document.getElementById('blogEditor').focus();
    if (value) document.execCommand(cmd, false, value);
}

function insertLink() {
    var url = prompt('URL:');
    if (url) {
        var text = prompt('ÎšÎµÎ¯Î¼ÎµÎ½Î¿ link:', '');
        if (text) {
            document.execCommand('insertHTML', false, '<a href="' + url + '">' + text + '</a>');
        } else {
            document.execCommand('createLink', false, url);
        }
    }
}

function insertCalcLink() {
    var calcs = {leave:'Î†Î´ÎµÎ¹Î±', netsalary:'ÎœÎ¹ÎºÏ„Î¬â†’ÎšÎ±Î¸Î±ÏÎ¬', severance:'Î‘Ï€Î¿Î¶Î·Î¼Î¯Ï‰ÏƒÎ·', overtime:'Î¥Ï€ÎµÏÏ‰ÏÎ¯ÎµÏ‚', bonus:'Î”ÏÏÎ¿ Î§ÏÎ¹ÏƒÏ„.', easter:'Î”ÏÏÎ¿ Î Î¬ÏƒÏ‡Î±'};
    var choice = prompt('Calculator: ' + Object.keys(calcs).join(', '));
    if (choice && calcs[choice]) {
        var text = prompt('ÎšÎµÎ¯Î¼ÎµÎ½Î¿:', 'Î¥Ï€Î¿Î»ÏŒÎ³Î¹ÏƒÎ­ Ï„Î¿');
        var html = '<a href="#" onclick="showPage(\'calculators\');setTimeout(function(){showCalc(\'' + choice + '\')},100)">' + text + '</a>';
        document.getElementById('blogEditor').focus();
        document.execCommand('insertHTML', false, html);
    }
}

function insertBlogLink() {
    var slug = prompt('Blog slug (Ï€.Ï‡. goniki-adeia):');
    if (slug) {
        var text = prompt('ÎšÎµÎ¯Î¼ÎµÎ½Î¿:', 'Î”Î¹Î¬Î²Î±ÏƒÎµ Ï„Î¿Î½ Ï€Î»Î®ÏÎ· Î¿Î´Î·Î³ÏŒ');
        var html = '<a href="#" onclick="showPage(\'blog\');setTimeout(function(){showBlogPost(\'' + slug + '\')},200)">' + text + '</a>';
        document.getElementById('blogEditor').focus();
        document.execCommand('insertHTML', false, html);
    }
}

function insertBr(target) {
    getEditor(target).focus();
    document.execCommand('insertHTML', false, '<br><br>');
}

function insertEmoji(target) {
    var emojis = 'ğŸ†• ğŸ›¡ï¸ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ âš ï¸ ğŸ’¡ âœ… âŒ ğŸ“Œ ğŸ”‘ ğŸ’° ğŸ“… â° ğŸ¯ ğŸ‘‰ ğŸ“„ ğŸ¢ ğŸ“‹ ğŸ¤° ğŸ‘¶';
    var e = prompt('Emoji: (Î® Î±Î½Ï„Î­Î³ÏÎ±ÏˆÎµ)\n' + emojis);
    if (e) {
        getEditor(target).focus();
        document.execCommand('insertText', false, e);
    }
}

function insertQaBlogLink() {
    var slug = prompt('Blog slug (Ï€.Ï‡. goniki-adeia):');
    if (slug) {
        var text = prompt('ÎšÎµÎ¯Î¼ÎµÎ½Î¿:', 'Î”Î¹Î¬Î²Î±ÏƒÎµ Ï„Î¿Î½ Ï€Î»Î®ÏÎ· Î¿Î´Î·Î³ÏŒ');
        var html = 'ğŸ‘‰ <a href="#" onclick="showPage(\'blog\');setTimeout(function(){showBlogPost(\'' + slug + '\')},200)">' + text + '</a>';
        document.getElementById('qaEditor').focus();
        document.execCommand('insertHTML', false, html);
    }
}

function insertQaCalcLink() {
    var choice = prompt('Calculator: leave, netsalary, severance, overtime, bonus, easter');
    if (choice) {
        var text = prompt('ÎšÎµÎ¯Î¼ÎµÎ½Î¿:', 'Î¥Ï€Î¿Î»ÏŒÎ³Î¹ÏƒÎ­ Ï„Î¿ ÎµÎ´Ï');
        var html = 'ğŸ‘‰ <a href="#" onclick="showPage(\'calculators\');setTimeout(function(){showCalc(\'' + choice + '\')},100)">' + text + '</a>';
        document.getElementById('qaEditor').focus();
        document.execCommand('insertHTML', false, html);
    }
}

// ========== SOURCE VIEW TOGGLE ==========
function toggleSource(type) {
    var editor = document.getElementById(type + 'Editor');
    var source = document.getElementById(type + 'Source');
    var btn = document.getElementById(type + 'SourceBtn');

    if (source.style.display === 'none' || source.style.display === '') {
        // Switch to source
        source.value = editor.innerHTML;
        editor.style.display = 'none';
        source.style.display = 'block';
        btn.classList.add('active');
    } else {
        // Switch to WYSIWYG
        editor.innerHTML = source.value;
        source.style.display = 'none';
        editor.style.display = 'block';
        btn.classList.remove('active');
    }
}

// ========== IMAGE PREVIEW ==========
function previewImage(input, areaId) {
    var area = document.getElementById(areaId);
    if (input.files && input.files[0]) {
        var reader = new FileReader();
        reader.onload = function(e) {
            area.classList.add('has-file');
            area.innerHTML = '<img src="' + e.target.result + '" class="upload-preview"><div style="font-size:0.78rem;color:var(--green);margin-top:0.35rem;">âœ… ' + input.files[0].name + '</div>';
        };
        reader.readAsDataURL(input.files[0]);
    }
}

// ========== SEO PREVIEW ==========
function updateSeoPreview() {
    var title = document.getElementById('blogMetaTitle').value || document.getElementById('blogTitle').value || 'Î¤Î¯Ï„Î»Î¿Ï‚ Î†ÏÎ¸ÏÎ¿Ï…';
    var desc = document.getElementById('blogMetaDesc').value || document.getElementById('blogSummary').value || 'Î ÎµÏÎ¹Î³ÏÎ±Ï†Î®...';
    var slug = document.getElementById('blogSlug').value || generateSlug(document.getElementById('blogTitle').value || 'slug');

    document.getElementById('seoPreviewTitle').textContent = title + ' â€” KnowYourWork';
    document.getElementById('seoPreviewUrl').textContent = 'knowyourwork.gr/blog/' + slug;
    document.getElementById('seoPreviewDesc').textContent = desc;
    document.getElementById('metaDescCount').textContent = document.getElementById('blogMetaDesc').value.length;
}

// ========== SLUG GENERATOR ==========
function generateSlug(text) {
    return text.toLowerCase()
        .replace(/[Î±Î¬]/g,'a').replace(/[ÎµÎ­]/g,'e').replace(/[Î·Î®]/g,'i').replace(/[Î¹Î¯]/g,'i')
        .replace(/[Î¿ÏŒ]/g,'o').replace(/[Ï…Ï]/g,'y').replace(/[Ï‰Ï]/g,'o')
        .replace(/[^a-z0-9]/g,'-').replace(/-+/g,'-').replace(/^-|-$/g,'');
}

// ========== KEYWORDS MANAGEMENT ==========
var qaKeywordList = [];

function handleKeyword(e) {
    if (e.key === 'Enter' || e.key === ',') {
        e.preventDefault();
        var val = e.target.value.trim();
        if (val && !qaKeywordList.includes(val)) {
            qaKeywordList.push(val);
            renderKeywords();
        }
        e.target.value = '';
    }
}

function removeKeyword(idx) {
    qaKeywordList.splice(idx, 1);
    renderKeywords();
}

function renderKeywords() {
    var container = document.getElementById('qaKeywords');
    var input = document.getElementById('qaKeywordInput');
    container.innerHTML = '';
    qaKeywordList.forEach(function(kw, i) {
        var tag = document.createElement('span');
        tag.className = 'keyword-tag';
        tag.innerHTML = kw + ' <span class="remove" onclick="removeKeyword(' + i + ')">Ã—</span>';
        container.appendChild(tag);
    });
    container.appendChild(input);
    updateSqlPreview();
}

// ========== SQL PREVIEW ==========
function updateSqlPreview() {
    var q = document.getElementById('qaQuestion').value.trim();
    var answer = document.getElementById('qaSource').style.display === 'block'
        ? document.getElementById('qaSource').value
        : document.getElementById('qaEditor').innerHTML;
    var cat = document.getElementById('qaCategory').value;
    var sort = document.getElementById('qaSortOrder').value || '?';
    var kw = qaKeywordList.map(function(k) { return "'" + k.replace(/'/g,"''") + "'"; }).join(',');

    var sql = "INSERT INTO chat_qa (keywords, question, answer, category, sort_order, is_active)\nVALUES\n" +
        "(ARRAY[" + kw + "],\n" +
        "'" + q.replace(/'/g,"''") + "',\n" +
        "'" + answer.replace(/'/g,"''") + "',\n" +
        "'" + cat + "', " + sort + ", true);";

    document.getElementById('qaSqlPreview').textContent = sql;
}

function generateSql() { updateSqlPreview(); }

function copySql() {
    updateSqlPreview();
    var text = document.getElementById('qaSqlPreview').textContent;
    navigator.clipboard.writeText(text).then(function() {
        alert('SQL copied!');
    });
}

// ========== SAVE BLOG POST ==========
async function saveBlogPost() {
    var btn = document.getElementById('blogSaveBtn');
    var status = document.getElementById('blogStatus');
    var editId = document.getElementById('blogEditId').value;

    var title = document.getElementById('blogTitle').value.trim();
    var content = document.getElementById('blogSource').style.display === 'block'
        ? document.getElementById('blogSource').value
        : document.getElementById('blogEditor').innerHTML;

    if (!title || !content) {
        showStatus(status, 'error', 'âŒ Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎµ Ï„Î¯Ï„Î»Î¿ ÎºÎ±Î¹ Ï€ÎµÏÎ¹ÎµÏ‡ÏŒÎ¼ÎµÎ½Î¿');
        return;
    }

    btn.disabled = true;
    btn.innerHTML = '<span class="spinner"></span> Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·...';

    try {
        // Upload image if selected
        var imageUrl = null;
        var fileInput = document.getElementById('blogImage');
        if (fileInput && fileInput.files && fileInput.files[0]) {
            imageUrl = await sbUploadImage(fileInput.files[0]);
        }

        var slug = document.getElementById('blogSlug').value.trim() || generateSlug(title);

        var postData = {
            title: title,
            slug: slug,
            summary: document.getElementById('blogSummary').value.trim(),
            content: content,
            tag: document.getElementById('blogTag').value,
            emoji: document.getElementById('blogEmoji').value.trim() || 'ğŸ“„',
            published: document.getElementById('blogPublished').classList.contains('on'),
            image_position: document.getElementById('blogImagePos').value,
            meta_title: document.getElementById('blogMetaTitle').value.trim() || null,
            meta_description: document.getElementById('blogMetaDesc').value.trim() || null
        };
        if (imageUrl) postData.image_url = imageUrl;

        if (editId) {
            await sbUpdate('blog_posts', editId, postData);
            showStatus(status, 'success', 'âœ… Î¤Î¿ Î¬ÏÎ¸ÏÎ¿ ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!');
        } else {
            await sbInsert('blog_posts', postData);
            showStatus(status, 'success', 'âœ… Î¤Î¿ Î¬ÏÎ¸ÏÎ¿ Î´Î·Î¼Î¿ÏƒÎ¹ÎµÏÏ„Î·ÎºÎµ!');
        }

        setTimeout(function() { resetBlogForm(); }, 2000);

    } catch(e) {
        showStatus(status, 'error', 'âŒ Î£Ï†Î¬Î»Î¼Î±: ' + e.message);
    }

    btn.disabled = false;
    btn.innerHTML = editId ? 'ğŸ’¾ Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·' : 'ğŸ’¾ Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ·';
}

// ========== SAVE Q&A ==========
async function saveQaEntry() {
    var btn = document.getElementById('qaSaveBtn');
    var status = document.getElementById('qaStatus');
    var editId = document.getElementById('qaEditId').value;

    var question = document.getElementById('qaQuestion').value.trim();
    var answer = document.getElementById('qaSource').style.display === 'block'
        ? document.getElementById('qaSource').value
        : document.getElementById('qaEditor').innerHTML;
    var category = document.getElementById('qaCategory').value;
    var sortOrder = parseInt(document.getElementById('qaSortOrder').value) || 0;

    if (!question || !answer) {
        showStatus(status, 'error', 'âŒ Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎµ ÎµÏÏÏ„Î·ÏƒÎ· ÎºÎ±Î¹ Î±Ï€Î¬Î½Ï„Î·ÏƒÎ·');
        return;
    }

    btn.disabled = true;
    btn.innerHTML = '<span class="spinner"></span> Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·...';

    try {
        var data = {
            keywords: qaKeywordList,
            question: question,
            answer: answer,
            category: category,
            sort_order: sortOrder,
            is_active: document.getElementById('qaActive').classList.contains('on')
        };

        if (editId) {
            await sbUpdate('chat_qa', editId, data);
            showStatus(status, 'success', 'âœ… Î¤Î¿ Q&A ÎµÎ½Î·Î¼ÎµÏÏÎ¸Î·ÎºÎµ!');
        } else {
            await sbInsert('chat_qa', data);
            showStatus(status, 'success', 'âœ… Î¤Î¿ Q&A Î±Ï€Î¿Î¸Î·ÎºÎµÏÏ„Î·ÎºÎµ!');
        }

        setTimeout(function() { resetQaForm(); }, 2000);

    } catch(e) {
        showStatus(status, 'error', 'âŒ Î£Ï†Î¬Î»Î¼Î±: ' + e.message);
    }

    btn.disabled = false;
    btn.innerHTML = editId ? 'ğŸ’¾ Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·' : 'ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·';
}

// ========== LOAD LISTS ==========
async function loadBlogList() {
    var container = document.getElementById('blogListItems');
    container.innerHTML = '<div style="padding:2rem;text-align:center;"><span class="spinner"></span> Î¦ÏŒÏÏ„Ï‰ÏƒÎ·...</div>';

    var data = await sbGet('blog_posts', 'order=created_at.desc');
    if (!data || data.length === 0) {
        container.innerHTML = '<div style="padding:2rem;text-align:center;color:var(--text-dim);">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Î¬ÏÎ¸ÏÎ±.</div>';
        return;
    }

    container.innerHTML = data.map(function(p) {
        var date = new Date(p.created_at).toLocaleDateString('el-GR');
        var pub = p.published ? '<span style="color:var(--green);">â—</span>' : '<span style="color:var(--red);">â—‹</span>';
        return '<div class="item-row">' +
            '<div class="item-info">' +
                '<div class="item-title">' + pub + ' ' + (p.emoji || 'ğŸ“„') + ' ' + p.title + '<span class="tag-badge">' + (p.tag || '') + '</span></div>' +
                '<div class="item-meta">' + date + ' Â· slug: ' + (p.slug || 'â€”') + (p.image_url ? ' Â· ğŸ–¼ï¸' : '') + '</div>' +
            '</div>' +
            '<div class="item-actions">' +
                '<button class="item-btn" onclick="editBlogPost(' + p.id + ')" title="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±">âœï¸</button>' +
                '<button class="item-btn del" onclick="deleteBlogPost(' + p.id + ')" title="Î”Î¹Î±Î³ÏÎ±Ï†Î®">âœ•</button>' +
            '</div>' +
        '</div>';
    }).join('');
}

async function loadQaList() {
    var container = document.getElementById('qaListItems');
    container.innerHTML = '<div style="padding:2rem;text-align:center;"><span class="spinner"></span> Î¦ÏŒÏÏ„Ï‰ÏƒÎ·...</div>';

    var data = await sbGet('chat_qa', 'order=sort_order.asc');
    if (!data || data.length === 0) {
        container.innerHTML = '<div style="padding:2rem;text-align:center;color:var(--text-dim);">Î”ÎµÎ½ Ï…Ï€Î¬ÏÏ‡Î¿Ï…Î½ Q&A entries.</div>';
        return;
    }

    container.innerHTML = data.map(function(q) {
        var active = q.is_active ? '<span style="color:var(--green);">â—</span>' : '<span style="color:var(--red);">â—‹</span>';
        var kws = (q.keywords || []).slice(0,4).join(', ');
        return '<div class="item-row">' +
            '<div class="item-info">' +
                '<div class="item-title">' + active + ' #' + (q.sort_order || '?') + ' ' + q.question + '<span class="tag-badge">' + (q.category || '') + '</span></div>' +
                '<div class="item-meta">Keywords: ' + kws + (q.keywords && q.keywords.length > 4 ? '...' : '') + '</div>' +
            '</div>' +
            '<div class="item-actions">' +
                '<button class="item-btn" onclick="editQaEntry(' + q.id + ')" title="Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±">âœï¸</button>' +
                '<button class="item-btn del" onclick="deleteQaEntry(' + q.id + ')" title="Î”Î¹Î±Î³ÏÎ±Ï†Î®">âœ•</button>' +
            '</div>' +
        '</div>';
    }).join('');
}

// ========== EDIT BLOG POST ==========
async function editBlogPost(id) {
    var data = await sbGet('blog_posts', 'id=eq.' + id);
    if (!data || !data[0]) return;
    var p = data[0];

    switchTab('blog');

    document.getElementById('blogEditId').value = p.id;
    document.getElementById('blogTitle').value = p.title || '';
    document.getElementById('blogTag').value = p.tag || 'Î“ÎµÎ½Î¹ÎºÎ¬';
    document.getElementById('blogEmoji').value = p.emoji || 'ğŸ“„';
    document.getElementById('blogSummary').value = p.summary || '';
    document.getElementById('blogSlug').value = p.slug || '';
    document.getElementById('blogMetaTitle').value = p.meta_title || '';
    document.getElementById('blogMetaDesc').value = p.meta_description || '';
    document.getElementById('blogImagePos').value = p.image_position || 'center';

    // Set published toggle
    var pubToggle = document.getElementById('blogPublished');
    if (p.published) pubToggle.classList.add('on');
    else pubToggle.classList.remove('on');

    // Load content into editor
    document.getElementById('blogEditor').innerHTML = p.content || '';

    // Show existing image
    if (p.image_url) {
        var area = document.getElementById('blogUploadArea');
        area.classList.add('has-file');
        area.innerHTML = '<img src="' + p.image_url + '" class="upload-preview"><div style="font-size:0.78rem;color:var(--text-muted);margin-top:0.35rem;">Î¤ÏÎ­Ï‡Î¿Ï…ÏƒÎ± ÎµÎ¹ÎºÏŒÎ½Î± (ÎºÎ»Î¹Îº Î³Î¹Î± Î±Î»Î»Î±Î³Î®)</div>';
        area.onclick = function() { document.getElementById('blogImage').click(); };
    }

    document.getElementById('blogFormTitle').textContent = 'âœï¸ Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±: ' + p.title;
    document.getElementById('blogSaveBtn').textContent = 'ğŸ’¾ Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·';

    updateSeoPreview();
    window.scrollTo({top: 0, behavior: 'smooth'});
}

// ========== EDIT Q&A ==========
async function editQaEntry(id) {
    var data = await sbGet('chat_qa', 'id=eq.' + id);
    if (!data || !data[0]) return;
    var q = data[0];

    switchTab('qa');

    document.getElementById('qaEditId').value = q.id;
    document.getElementById('qaQuestion').value = q.question || '';
    document.getElementById('qaCategory').value = q.category || 'general';
    document.getElementById('qaSortOrder').value = q.sort_order || '';

    // Active toggle
    var actToggle = document.getElementById('qaActive');
    if (q.is_active) actToggle.classList.add('on');
    else actToggle.classList.remove('on');

    // Keywords
    qaKeywordList = q.keywords || [];
    renderKeywords();

    // Answer
    document.getElementById('qaEditor').innerHTML = q.answer || '';

    document.getElementById('qaFormTitle').textContent = 'ğŸ’¬ Î•Ï€ÎµÎ¾ÎµÏÎ³Î±ÏƒÎ¯Î±: ' + q.question;
    document.getElementById('qaSaveBtn').textContent = 'ğŸ’¾ Î•Î½Î·Î¼Î­ÏÏ‰ÏƒÎ·';

    window.scrollTo({top: 0, behavior: 'smooth'});
}

// ========== DELETE ==========
async function deleteBlogPost(id) {
    if (!confirm('Î£Î¯Î³Î¿Ï…ÏÎ± Î¸ÎµÏ‚ Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ Î±Ï…Ï„ÏŒ Ï„Î¿ Î¬ÏÎ¸ÏÎ¿;')) return;
    try {
        await sbDelete('blog_posts', id);
        loadBlogList();
    } catch(e) { alert('Î£Ï†Î¬Î»Î¼Î±: ' + e.message); }
}

async function deleteQaEntry(id) {
    if (!confirm('Î£Î¯Î³Î¿Ï…ÏÎ± Î¸ÎµÏ‚ Î½Î± Î´Î¹Î±Î³ÏÎ¬ÏˆÎµÎ¹Ï‚ Î±Ï…Ï„ÏŒ Ï„Î¿ Q&A;')) return;
    try {
        await sbDelete('chat_qa', id);
        loadQaList();
    } catch(e) { alert('Î£Ï†Î¬Î»Î¼Î±: ' + e.message); }
}

// ========== RESET FORMS ==========
function resetBlogForm() {
    document.getElementById('blogEditId').value = '';
    document.getElementById('blogTitle').value = '';
    document.getElementById('blogTag').value = 'Î†Î´ÎµÎ¹ÎµÏ‚';
    document.getElementById('blogEmoji').value = 'ğŸ“„';
    document.getElementById('blogSummary').value = '';
    document.getElementById('blogSlug').value = '';
    document.getElementById('blogMetaTitle').value = '';
    document.getElementById('blogMetaDesc').value = '';
    document.getElementById('blogImagePos').value = 'center';
    document.getElementById('blogEditor').innerHTML = '';
    document.getElementById('blogSource').value = '';
    document.getElementById('blogPublished').classList.add('on');
    document.getElementById('blogFormTitle').textContent = 'âœï¸ ÎÎ­Î¿ Î†ÏÎ¸ÏÎ¿';
    document.getElementById('blogSaveBtn').textContent = 'ğŸ’¾ Î”Î·Î¼Î¿ÏƒÎ¯ÎµÏ…ÏƒÎ·';
    document.getElementById('blogStatus').className = 'status-msg';
    document.getElementById('blogStatus').style.display = 'none';

    // Reset upload area
    var area = document.getElementById('blogUploadArea');
    area.classList.remove('has-file');
    area.innerHTML = '';
    var fi = document.createElement('input');
    fi.type = 'file'; fi.id = 'blogImage'; fi.accept = 'image/*'; fi.style.display = 'none';
    fi.onchange = function() { previewImage(fi, 'blogUploadArea'); };
    area.appendChild(fi);
    var txt = document.createElement('div');
    txt.id = 'blogImageText';
    txt.textContent = 'ğŸ“· Î£ÏÏÎµ Î® ÎºÎ»Î¯ÎºÎ±ÏÎµ Î³Î¹Î± ÎµÎ¹ÎºÏŒÎ½Î±';
    area.appendChild(txt);
    area.onclick = function() { fi.click(); };

    // Reset source view
    document.getElementById('blogEditor').style.display = 'block';
    document.getElementById('blogSource').style.display = 'none';
    document.getElementById('blogSourceBtn').classList.remove('active');

    updateSeoPreview();
}

function resetQaForm() {
    document.getElementById('qaEditId').value = '';
    document.getElementById('qaQuestion').value = '';
    document.getElementById('qaCategory').value = 'leave';
    document.getElementById('qaSortOrder').value = '';
    document.getElementById('qaEditor').innerHTML = '';
    document.getElementById('qaSource').value = '';
    document.getElementById('qaActive').classList.add('on');
    document.getElementById('qaFormTitle').textContent = 'ğŸ’¬ ÎÎ­Î¿ Q&A Entry';
    document.getElementById('qaSaveBtn').textContent = 'ğŸ’¾ Î‘Ï€Î¿Î¸Î®ÎºÎµÏ…ÏƒÎ·';
    document.getElementById('qaStatus').className = 'status-msg';
    document.getElementById('qaStatus').style.display = 'none';
    document.getElementById('qaSqlPreview').textContent = '-- Î£Ï…Î¼Ï€Î»Î®ÏÏ‰ÏƒÎµ Ï„Î± Ï€ÎµÎ´Î¯Î± Ï€Î±ÏÎ±Ï€Î¬Î½Ï‰...';

    qaKeywordList = [];
    renderKeywords();

    // Reset source view
    document.getElementById('qaEditor').style.display = 'block';
    document.getElementById('qaSource').style.display = 'none';
    document.getElementById('qaSourceBtn').classList.remove('active');
}

// ========== HELPERS ==========
function showStatus(el, type, msg) {
    el.className = 'status-msg ' + type;
    el.textContent = msg;
    el.style.display = 'block';
    if (type === 'success') {
        setTimeout(function() { el.style.display = 'none'; }, 3000);
    }
}

// Listen for input changes to update SQL preview
document.getElementById('qaQuestion').addEventListener('input', updateSqlPreview);
document.getElementById('qaCategory').addEventListener('change', updateSqlPreview);
document.getElementById('qaSortOrder').addEventListener('input', updateSqlPreview);
document.getElementById('qaEditor').addEventListener('input', updateSqlPreview);

</script>

</div><!-- /mainApp -->

<script>
// Password gate (fallback security â€” primary is Cloudflare Access)
var ADMIN_HASH = '7f1d7029462cecf34581c7cf53bc83246a04fadb6b33804777c58ae3d52c19e8'; // SHA-256 of password

// To generate a new hash, run in browser console:
// crypto.subtle.digest('SHA-256', new TextEncoder().encode('YOUR_PASSWORD')).then(h => console.log(Array.from(new Uint8Array(h)).map(b=>b.toString(16).padStart(2,'0')).join('')))

async function hashPass(pass) {
    var buf = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(pass));
    return Array.from(new Uint8Array(buf)).map(function(b){return b.toString(16).padStart(2,'0')}).join('');
}

async function checkAuth() {
    var pass = document.getElementById('authPass').value;
    var hash = await hashPass(pass);
    if (hash === ADMIN_HASH) {
        document.getElementById('authGate').style.display = 'none';
        document.getElementById('mainApp').style.display = 'block';
        sessionStorage.setItem('kyw_admin', 'ok');
    } else {
        document.getElementById('authError').style.display = 'block';
        document.getElementById('authPass').value = '';
    }
}

// Auto-login if already authed this session
if (sessionStorage.getItem('kyw_admin') === 'ok') {
    document.getElementById('authGate').style.display = 'none';
    document.getElementById('mainApp').style.display = 'block';
}
</script>

</body>
</html>
